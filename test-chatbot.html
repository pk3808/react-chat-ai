<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React AI Chatbot Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            min-height: 100vh;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .instructions {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>React AI Chatbot Test</h1>
        <div class="instructions">
            <p><strong>Test the fixes:</strong></p>
            <ul>
                <li>Test different positions: bottom-right, bottom-left, top-right, top-left</li>
                <li>Send multiple messages to verify the chat container doesn't expand beyond 600px</li>
                <li>Check that the chat area becomes scrollable when messages overflow</li>
                <li>Verify the widget appears in the correct position</li>
            </ul>
        </div>
        
        <!-- Test buttons to change position -->
        <div style="margin: 20px 0; text-align: center;">
            <h3>Test Positions:</h3>
            <button onclick="changePosition('bottom-right')" style="margin: 5px; padding: 10px;">Bottom Right</button>
            <button onclick="changePosition('bottom-left')" style="margin: 5px; padding: 10px;">Bottom Left</button>
            <button onclick="changePosition('top-right')" style="margin: 5px; padding: 10px;">Top Right</button>
            <button onclick="changePosition('top-left')" style="margin: 5px; padding: 10px;">Top Left</button>
        </div>
    </div>

    <div id="root"></div>

    <script type="text/babel">
        // Simulate the chatbot component with the fixes
        const { useState } = React;
        
        // Simple test component to demonstrate the chatbot would work
        function TestChatWidget({ position }) {
            const [isOpen, setIsOpen] = useState(false);
            const [messages, setMessages] = useState([
                { id: 1, content: "Hello! This is a test message.", role: "assistant", timestamp: new Date() },
                { id: 2, content: "The chat container should not expand beyond its fixed height.", role: "assistant", timestamp: new Date() },
                { id: 3, content: "Instead, the message area should become scrollable when needed.", role: "assistant", timestamp: new Date() },
                { id: 4, content: "This is another test message to demonstrate scrolling.", role: "assistant", timestamp: new Date() },
                { id: 5, content: "Position is set to: " + position, role: "assistant", timestamp: new Date() },
            ]);
            
            // Add more messages to test scrolling
            React.useEffect(() => {
                const addMessages = () => {
                    for (let i = 6; i <= 20; i++) {
                        setTimeout(() => {
                            setMessages(prev => [...prev, {
                                id: i,
                                content: `Test message #${i} to make the chat scrollable`,
                                role: "assistant",
                                timestamp: new Date()
                            }]);
                        }, i * 200);
                    }
                };
                addMessages();
            }, []);
            
            const positionStyle = {
                position: 'fixed',
                bottom: position.includes('bottom') ? '24px' : 'auto',
                right: position.includes('right') ? '24px' : 'auto',
                left: position.includes('left') ? '24px' : 'auto',
                top: position.includes('top') ? '24px' : 'auto',
                zIndex: 50,
            };
            
            if (!isOpen) {
                return (
                    <div style={positionStyle}>
                        <button
                            onClick={() => setIsOpen(true)}
                            style={{
                                width: '56px',
                                height: '56px',
                                borderRadius: '50%',
                                backgroundColor: '#4F46E5',
                                color: 'white',
                                boxShadow: '0 4px 20px rgba(0,0,0,0.3)',
                                border: 'none',
                                cursor: 'pointer'
                            }}
                        >
                            ðŸ’¬
                        </button>
                    </div>
                );
            }
            
            return (
                <div style={positionStyle}>
                    <div 
                        style={{ 
                            width: '410px', 
                            height: '600px',
                            border: '1px solid #ccc',
                            borderRadius: '16px',
                            boxShadow: '0 25px 50px rgba(0,0,0,0.3)',
                            backgroundColor: 'white',
                            display: 'flex',
                            flexDirection: 'column',
                            overflow: 'hidden'
                        }}
                    >
                        <div 
                            style={{
                                padding: '16px',
                                backgroundColor: '#f9fafb',
                                borderBottom: '1px solid #e5e7eb',
                                display: 'flex',
                                justifyContent: 'space-between',
                                alignItems: 'center',
                                flexShrink: 0
                            }}
                        >
                            <div>
                                <h3 style={{ margin: 0, fontSize: '14px', fontWeight: 'bold' }}>AI Assistant</h3>
                                <p style={{ margin: 0, fontSize: '12px', color: '#6b7280' }}>Online now</p>
                            </div>
                            <button 
                                onClick={() => setIsOpen(false)}
                                style={{
                                    background: 'none',
                                    border: 'none',
                                    fontSize: '18px',
                                    cursor: 'pointer'
                                }}
                            >
                                âœ•
                            </button>
                        </div>
                        
                        <div 
                            style={{ 
                                flex: 1, 
                                overflowY: 'auto', 
                                padding: '16px',
                                backgroundColor: '#f9fafb',
                                display: 'flex',
                                flexDirection: 'column'
                            }}
                        >
                            {messages.map((msg) => (
                                <div 
                                    key={msg.id} 
                                    style={{ 
                                        marginBottom: '12px',
                                        maxWidth: '80%',
                                        padding: '12px',
                                        borderRadius: '16px',
                                        backgroundColor: msg.role === 'assistant' ? '#e5e7eb' : '#4f46e5',
                                        color: msg.role === 'assistant' ? '#1f2937' : 'white',
                                        alignSelf: msg.role === 'assistant' ? 'flex-start' : 'flex-end'
                                    }}
                                >
                                    {msg.content}
                                    <div style={{ fontSize: '10px', marginTop: '4px', opacity: 0.7 }}>
                                        {msg.timestamp.toLocaleTimeString()}
                                    </div>
                                </div>
                            ))}
                            <div ref={() => {}} style={{ flex: 1 }}></div>
                        </div>
                        
                        <div style={{ padding: '16px', backgroundColor: '#f9fafb', borderTop: '1px solid #e5e7eb' }}>
                            <div style={{ display: 'flex', alignItems: 'center' }}>
                                <input 
                                    type="text" 
                                    placeholder="Type your message..." 
                                    style={{ 
                                        flex: 1, 
                                        padding: '8px 12px', 
                                        border: '1px solid #d1d5db', 
                                        borderRadius: '8px',
                                        marginRight: '8px'
                                    }}
                                    onKeyPress={(e) => {
                                        if (e.key === 'Enter') {
                                            const newMsg = {
                                                id: messages.length + 1,
                                                content: e.target.value,
                                                role: "user",
                                                timestamp: new Date()
                                            };
                                            setMessages(prev => [...prev, newMsg]);
                                            e.target.value = '';
                                        }
                                    }}
                                />
                                <button 
                                    style={{
                                        padding: '8px 12px',
                                        backgroundColor: '#4f46e5',
                                        color: 'white',
                                        border: 'none',
                                        borderRadius: '8px',
                                        cursor: 'pointer'
                                    }}
                                >
                                    Send
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        function App() {
            const [position, setPosition] = useState('bottom-right');
            
            window.changePosition = (pos) => {
                setPosition(pos);
            };
            
            return (
                <TestChatWidget position={position} />
            );
        }
        
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
